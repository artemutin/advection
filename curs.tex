%% LyX 2.0.6 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[12pt,english,russian]{article}
\renewcommand{\rmdefault}{cmr}
\renewcommand{\sfdefault}{cmss}
\renewcommand{\ttdefault}{cmtt}
\usepackage[T2A,T1]{fontenc}
\usepackage[latin9,koi8-r]{inputenc}
\usepackage{geometry}
\geometry{verbose,tmargin=2cm,bmargin=2cm,lmargin=3cm,rmargin=1cm}
\setlength{\parskip}{\smallskipamount}
\setlength{\parindent}{0pt}
\usepackage{babel}
\usepackage{float}
\usepackage{textcomp}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{setspace}
\usepackage[numbers]{natbib}
\onehalfspacing
\usepackage[unicode=true,pdfusetitle,
 bookmarks=true,bookmarksnumbered=false,bookmarksopen=false,
 breaklinks=false,pdfborder={0 0 1},backref=false,colorlinks=false]
 {hyperref}
\usepackage{breakurl}

\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
\DeclareRobustCommand{\cyrtext}{%
  \fontencoding{T2A}\selectfont\def\encodingdefault{T2A}}
\DeclareRobustCommand{\textcyr}[1]{\leavevmode{\cyrtext #1}}
\AtBeginDocument{\DeclareFontEncoding{T2A}{}{}}

%% A simple dot to overcome graphicx limitations
\newcommand{\lyxdot}{.}


\makeatother

\begin{document}
\noindent \begin{center}
\thispagestyle{empty}МИНИСТЕРСТВО ОБРАЗОВАНИЯ И НАУКИ РОССИЙСКОЙ
ФЕДЕРАЦИИ 
\par\end{center}

\noindent \begin{center}
Федеральное государственное автономное образовательное учреждение
\\
высшего профессионального образования \\
\textbf{\guillemotleft{}Дальневосточный Федеральный Университет\guillemotright{}}
\par\end{center}

\rule[0.1ex]{1\columnwidth}{4pt}

\noindent \begin{center}
\textbf{ШКОЛА ЕСТЕСТВЕННЫХ НАУК\medskip{}
}
\par\end{center}

\noindent \begin{center}
\textbf{Кафедра информатики, математического и компьютерного моделирования\bigskip{}
}
\par\end{center}

\noindent \begin{center}
Утин Артем Сергеевич
\par\end{center}

\noindent \begin{center}
ТЕМА\smallskip{}

\par\end{center}

\noindent \begin{center}
\textbf{КУРСОВАЯ РАБОТА}
\par\end{center}

\noindent \begin{center}
\medskip{}

\par\end{center}

\noindent \begin{flushright}
Студент гр. Б8303б \_\_\_\_\_\_\_\_\_\_\_
\par\end{flushright}

\noindent \begin{flushright}
Руководитель \\
\_\_\_\_\_\_\_\_\_\_\_ А.А. Баранов
\par\end{flushright}

\pagebreak{}


\section{Оглавление}

\tableofcontents{}\pagebreak{}


\section{Введение}

В современном математическом моделировании широко распространены алгоритмы
под общим названием ``методы частиц''. Общей характерной особенностью
данных методов является концепция перехода к дискретной аппроксимации
- она заключается в представлении среды в виде конечного множества
взаимодействующих друг с другом частиц, каждая из которых является
носителем некоторых физических характеристик. Численные методы на
их основе этих алгоритмов часто используются для проведения масштабных
вычислительных экспериментов в различных областях науки. Так разновидности
этих методов используются при расчетах физических процессов в установках
термоядерного синтеза, этими методами проводились расчеты обтекания
сложных космических аппаратов типа ``Буран''.\citet{key-6} 

В частности, подгруппа методов ``частицы-в-ячейках'' находит широкое
применение в задачах гидродинамики. Одним из этапов в общей схеме
данных алгоритмов связан с решением задачи переноса частиц. Применительно
к гидродинамическим процессам перемешивания среды данная задача в
современной литературе получила название ``задача об адвекции частицы
в известном поле скорости''\citet[с.123]{key-7}.

Решение задачи адвекции требует построения комплексных численных схем,
включающих в себя численные методы решения обыкновенных дифференциальных
уравнений, методы многомерной и одномерной интерполяции на сетках
и интерполяции от рассеяных частиц к сетке. 

Целью данной работы является проведение сравнительного анализа двух
групп методов численного интегрирования ОДУ - многошаговых и Рунге-Кутта,
а также методов одно- и двумерного интерполирования, сравнение этих
методов по точности и вычислительной эффективности и построение по
итогам тестов комбинированной численной схемы, являющейся оптимальной
по соотношению точность/производительность. Тестирование и анализ
методов проводился на задаче адвекции в известном поле скорости, допускающей
аналитическое решение для анализа погрешности. После чего схема была
применена на задаче хаотической адвекции. 

В первой части работы приводится теоретическое описание рассматриваемых
методов, во второй части данные методы тестируются на модельной задаче
и в рамках численного эксперимента проводится их практическое сравнение.


\section{Постановка задачи}

Рассмотрим методы решения уравнения движения частиц, т.е обыкновенных
дифференциальных уравнений, а также возникающие при дальнейшей дискретизации
задачи методы одно- и двумерного интерполирования на прямоугольных
cетках. Приведем теоретические и практические оценки сходимости, устойчивости
и вычислительной сложности алгоритмов с использованием модельной задачи
лагранжева переноса пассивных частиц в двумерном поле скорости. 


\subsection{Общая математическая модель}

Дано множество $M$ частиц, заданных в момент времени $t_{0}=0$ своими
Лагранжевыми координатами $(x_{i},y_{i})\in\mathbb{\Gamma\subset R}^{2}\;\forall i\in M.$
Для $\mathbb{R}^{2}$ задано поле скорости \inputencoding{latin9}\foreignlanguage{english}{$V=[v(x,y,t),\, u(x,y,t)]$}\inputencoding{koi8-r}
. Необходимо расчитать процесс переноса частиц в интервале времени
$t\in[0,T]$, т.е определить $x_{i}(t),y_{i}(t)\;\forall i\in M$
- траектории частиц. 

Математической моделью движения отдельной частицы в поле скорости
будет система обыкновенных дифференциальных уравнений вида:
\begin{align}
 & \frac{dx_{i}}{dt}=u(x_{i},y_{i},t),\nonumber \\
 & \frac{dy_{i}}{dt}=v(x_{i},y_{i},t);\label{eq:ODE_system}
\end{align}


Согласно теореме существования решения системы линейных дифференциальных
уравнений\citep[с.126]{key-5} для системы \ref{eq:ODE_system} и
начальных условий 
\begin{equation}
t_{0}=0,\;(x_{0},y_{0})\in\mathbb{R}^{2}\label{eq:Start_cond}
\end{equation}
 существует решение $x(t),y(t)$, определенное на в некоторой области
$[0,r]$$\times\Gamma$, где $\Gamma\in\mathbb{R}^{2}$ - открытое
множество, для которого $u,v\in C^{1}(\Gamma$), причем если существует
два решения, определенных на общем интервале $t$, то они совпадают
всюду на этом интервале. \\
Таким образом, решение задачи 2.1 сводится к решению $|M|$ задач
Коши \ref{eq:ODE_system}-\ref{eq:Start_cond}.


\subsection{Дискретизация задачи}

Численное решение модельной задачи проводилось в области $G\times[0,T]$,
$G\subset\mathbb{R}^{2}=\{(x,y):\,|x|\leq3,\,|y|\leq3\}$.

Для использования методами численного интегрирования на отрезке $[0,T]$
вводилась равномерная сетка $\omega_{1}(t,h)=\{rh,\; r=0,1,...,N_{1},\; h=\frac{T}{N_{1}}\}$
c различными значениями $N_{1}$. В ряде тестов применялась дискретизация
пространства и вводилась двумерная прямоугольная равномерная сетка
$\omega_{2}(\Gamma,h_{2})=\{(x_{i},y_{j})=(-3+h_{2}i,-3+h_{2}j),\; i,j=0,1,...,N_{2},\; h_{2}=\frac{6}{N_{2}}\}$,
которая учитывала центральную симметрию поля скорости, а также то,
что $V_{\tau}\approx0$ при $r\rightarrow3$. Кроме того, в последних
тестах поле скорости $V_{\tau}(r,t)$ было задано в узлах сетки на
$[0,T]$ $\omega_{3}(t,h_{3})=\{rh,\; r=0,1,...,N_{3},\; h=\frac{T}{N_{3}}\}$,
где $N_{3}$в общем случае не совпадает с $N_{1}$.


\subsection{Примененные методы}

В ходе работы был рассмотрен целый ряд методов интегрирования ОДУ,
которые можно разделить на 2 группы - многошаговые методы и методы
Рунге-Кутта. В первой группе были рассмотрены следующие методы:
\begin{enumerate}
\item Метод Эйлера (1го порядка аппроксимации)
\item Методы Эйлера с пересчетом и центральных разностей (2го порядка)
\item Метод Рунге-Кутта (3го порядка)
\item Метод Рунге-Кутта (4го порядка)
\end{enumerate}
Во второй группе были рассмотрены следующие методы:
\begin{enumerate}
\item Метод Адамса-Моултона (3го порядка)
\item Метод Адамса-Моултона (4го порядка)
\end{enumerate}
Для случая, когда поле скорости задано только в узлах пространственной
сетки применялись следующие методы двумерного интерполирования:
\begin{enumerate}
\item Билинейная интерполяция
\item Биквадратичная интерполяция
\item Бикубическая интерполяция
\item Интерполяция полиномом Эрмита
\item Интерполяция кубическим сплайном $S_{3,1}$
\end{enumerate}
Наконец, при дискретизации задачи во времени использовались методы
одномерной интерполяции:
\begin{enumerate}
\item Линейная интерполяция
\item Квадратичная интерполяция
\item Кубическая интерполяция
\end{enumerate}

\section{Теоретический материал}


\subsection{Методы численного решения задачи Коши для ОДУ}

Общепринятым принципом теоретического изложения методов решения задачи
Коши для ОДУ и их систем является рассмотрения методов на единственном
ОДУ, после чего методы без изменений переносятся на системы путем
векторизации аргументов. 

Поэтому будем рассматривать задачу Коши для системы обыкновенного
дифференциального уравнения:
\begin{equation}
\frac{du(t)}{dt}=f(t,u),\; t>0,\; u(0)=u^{0}\label{eq:Cauchy problem}
\end{equation}


При исследовании численных методов для задачи Коши будем предполагать,
что ее решение существует, единственно и обладает необходимой гладкостью.

Существуют две группы численных методов для решения задачи Коши: многошаговые
методы Адамса и методы Рунге-Кутта.


\subsubsection{Методы Рунге-Кутта}

В общем случае, явный $m$-этапный метод Рунге-Кутта состоит в следующем\citet[, с.218]{key-1}.
Пусть известно приближенное решение $y_{n}=y(t_{n})$. Зададим числовые
коэффициенты $a_{i},\; b_{ij},\; i=2..m,\; j=1..m-1,\;\sigma_{i},\; i=1..m$
и последовательно вычисляются некоторые функции 
\begin{align*}
k_{1} & =f(t_{n,}y_{n}),\; k_{2}=f(t_{n}+a_{2}\tau,\, y_{n}+b_{21}\tau k_{1}),\\
...\\
k_{m} & =f(t_{n}+a_{m}\tau,\; y_{n}+b_{m1}\tau k_{1}+...+b_{m,m-1}\tau k_{m-1})
\end{align*}
\\
После чего из формулы 
\begin{equation}
\frac{y_{n+1}-y_{n}}{\tau}=\sum_{i=1}\sigma_{i}k_{i}\label{eq:runge_main}
\end{equation}
\\
находится новое значение $y_{n+1}$. Коэффициенты $a_{i},\; b_{ij},\;\sigma_{i}$
выбираются из соображений точности. Например, для того чтобы \ref{eq:runge_main}
аппроксимировало исходную задачу \ref{eq:Cauchy problem} требуется
${\displaystyle \sum_{i=1}^{m}\sigma_{i}=1}$.

При $m=1$ получаем наиболее простую формулу - метод Эйлера, или метод
ломанных, поскольку на каждом шаге метода мы приближаем интегральную
кривую отрезком касательной к ней в точке $(t_{n},y_{n})$. 
\[
y_{n+1}=y_{n}+\tau f(t_{n},y_{n})
\]
\\
Введя на отрезке $[0,T]$ равномерную сетку $\omega_{\tau}$в качестве
решения задачи Коши мы получим сеточную функцию $y_{n}$.

Говорят, что метод имеет $p$-й порядок точности, если $\exists p>0:\;|y_{n}-u_{n}|=O(\tau^{p})$
при $\tau\rightarrow0$, где $u_{n}$-точное решение. Метод имеет
$p$-й порядок аппроксимации, если невязка $\psi_{n}=f(t_{n},u_{n})-\frac{u_{n+1}-u_{n}}{\tau}=O(\tau^{p})$.
Для методов Рунге-Кутта справедлива теорема, о том что, порядок точности
и порядок аппроксимации для этого семейства методов совпадает. Для
метода Эйлера порядок аппроксимации есть $O(\tau)$. Данный метод
не относится к числу широко используемых в реальных вычислительных
задачах в силу малого порядка точности.

При $m=2$ получаем семейство методов, для которых при различных значениях
параметров возможно построение схем как первого (при $\sigma_{1}+\sigma_{2}=1$),
так и второго порядка точности (при дополнительном условии $\sigma_{2}b_{21}=\sigma_{2}a_{2}=0.5$).
Схемы второго порядка точности имеют общий вид:
\begin{equation}
\frac{y_{n+1}-y_{n}}{\tau}=(1-\sigma)f(t_{n},y_{n})+\sigma f(t_{n}+a\tau,y_{n}+a\tau f(t_{n},y_{n}))\label{eq:runge_2}
\end{equation}


где $\sigma a=0.5$. При $\sigma=1,\; a=0.5$ получаем метод 
\[
\frac{y_{n+1}-y_{n}}{\tau}=f(t_{n}+\frac{1}{2}\tau,y_{n}+\frac{1}{2}\tau f(t_{n},y_{n})),
\]


который реализует схему ``предиктор-корректор'' - начальное приближение,
полученное по методу Эйлера для половинного узла затем уточняется
тем же методом Эйлера, реализуя на самом деле схему численного интегрирования
методом центральных прямоугольников, что, как известно, обеспечивает
порядок точности $O(\tau^{2}).$ При $\sigma=0.5,\; a=1$ получаем
другой метод, известный как метод Эйлера с пересчетом, тоже второго
порядка точности(тоже предиктор-корректор?)
\begin{align*}
k_{1} & =f(t_{n},y_{n}),\; k_{2}=f(t_{n}+\tau,y_{n}+\tau k_{1}),\\
 & y_{n+1}=y_{n}+\frac{1}{2}\tau(k_{1}+k_{2})
\end{align*}
Дальнейшее увеличение порядка точности требует увеличения числа промежуточных
этапов в вычислении.

В данной работе быда использована следующая трехэтапная схема 3его
порядка точности:
\begin{multline*}
k_{1}=f(t_{n},y_{n}),\; k_{2}=f(t_{n}+\frac{\tau}{2},y_{n}+\frac{\tau k_{1}}{2}),\\
k_{3}=f(t_{n}+\tau,y_{n}-\tau k_{1}+2\tau k_{2})\\
\frac{y_{n+1}-y_{n}}{\tau}=\frac{1}{6}(k_{1}+4k_{2}+k_{3})
\end{multline*}
Также широко применима четырехэтапная схема четвертого порядка точности:
\begin{align*}
k_{1} & =f(t_{n},y_{n}),\; k_{2}=f(t_{n}+\frac{\tau}{2},y_{n}+\frac{\tau k_{1}}{2}),\\
 & k_{3}=f(t_{n}+\frac{\tau}{2},y_{n}+\frac{\tau k_{2}}{2}),k_{4}=f(t_{n}+\tau,y_{n}+\tau k_{3}),\\
\frac{y_{n+1}-y_{n}}{\tau} & =\frac{1}{6}(k_{1}+2k_{2}+2k_{3}+k_{4})
\end{align*}


В отношении сходимости методов Рунге-Кутта справедлива следующая теорема\citep[, c.223]{key-1}:
Пусть $|f_{u}(t,u)|\leq L$, $\psi_{j}$ - невязка метода, $n\tau<T,$
тогда справедлива оценка 
\[
|y_{n}-u_{n}|\leq Te^{\alpha T}\underset{0\leq i\leq n-1}{max}(\psi_{j}),
\]


где $\alpha=\sigma Lm(1+Lb\tau)^{n-1}$, $\sigma=max|\sigma_{i}|,$
$b=max|b_{ij}|$. Т.е если метод Рунге-Кутта аппроксимирует исходное
уравнение с порядком $O(\tau^{p}),$ то при $\tau\rightarrow0$ он
сходится с тем же порядком точности. В предположении $f=f(x)$ оценки
упрощаются при использовании формул численного интегрирования, соответствующих
методам Рунге-Кутты\citep[, c.249]{key-3}: $R_{\text{сред}}=\frac{T}{24}h^{2}max|f''|,\; R_{\text{трап}}=\frac{T}{12}h^{2}max|f''|,\; R_{\text{симп}}=\frac{T}{2880}h^{4}max|f^{iv}|$
которые соответствуют методу средних прямоугольников, методу Эйлера
с пересчетом и методу Рунге-Кутта 4 порядка. 

В отношении производительности методов, можно отметить, что за один
шаг $\tau$ методами Рунге-Кутта производится столько же обращений
к вычислению правой части, каков и порядок метода. При этом, за исключением
метода Эйлера с пересчетом, вычисления правой части производится также
в промежуточных узлах $\frac{\tau}{2}$, что потребует удвоения густоты
сетки при интерполяции по времени. Именно поэтому, из рассмотрения
были исключены другие варианты методов Рунге-Кутта таких же порядков,
поскольку они требуют вычисления правой части в еще большем числе
промежуточных точек $t$.


\subsubsection{Методы Адамса}

В методах Рунге-Кутта для построения решения в данный момент времени
использовалось только одно предыдущее значение $y_{n}$. Вполне обоснованной
является идея применения нескольких ранее вычисленных значений для
расчета текущего значения. Такие методы называют многошаговыми. Линейным
$m-$шаговым разностным методом называется система разностных уравнений
\begin{align}
\frac{a_{0}y_{n}+a_{1}y_{n-1}+...+a_{m}y_{n-m}}{\tau} & =b_{0}f_{n}+b_{1}f_{n-1}+...+b_{m}f_{n-m},\label{eq:many_steps}\\
n=m,m+1,...\nonumber 
\end{align}
\\
где $a_{k},b_{k}$- числовые коэффициенты, не зависящие от $n$, a
$a_{0}\neq0$. Расчет по таким формулам возможен начиная с $n$-ого
элемента, поэтому начальные значения $y_{0},...,y_{n-1}$ должны быть
предварительно известны, или вычислены другими методами. Метод \ref{eq:many_steps}
является явным, если $b_{0}=0,$ и тогда возможно явно выразить значение
$y_{n}$. В обратном случае метод является неявным и тогда необходимо
решать нелинейное уравнение или строить схему по принципу предиктор-корректор.
Для того, чтобы правая часть уравнения \ref{eq:many_steps} аппроксимировала
правую часть исходного уравнения, необходимо выполнение равенства
${\displaystyle \sum_{k=0}^{m}}b_{k}=1$.

В практике вычислений наибольшее распространение получили методы Адамса,
являющиеся частным случаем формул \ref{eq:many_steps}, когда аппроксимация
производной в левой части проводится всего по двум точкам
\begin{equation}
\frac{y_{n}-y_{n-1}}{\tau}=\sum_{k=0}^{m}b_{k}f_{n-k}
\end{equation}


Хотя возможно построение многошаговых схем вплоть до порядка аппроксимации
$2m$, однако они малопригодны для расчетов из-за неустойчивости.
Для методов Адамса порядок аппроксимации скромнее - до $m+1$ при
неявных схемах, и до $m$ при явных. В ходе вычислительных экспериментов
были рассмотрены 3 многошаговых метода Адамса, построенные по принципу
``предиктор-корректор''. За основу были взяты следующие явные методы
Адамса:
\begin{multline*}
\frac{y_{n}-y_{n-1}}{\tau}=\frac{1}{2}(3f_{n-1}-f_{n-2})\\
\frac{y_{n}-y_{n-1}}{\tau}=\frac{1}{12}(23f_{n-1}-16f_{n-2}+5f_{n-3})\\
\frac{y_{n}-y_{n-1}}{\tau}=\frac{1}{24}(55f_{n-1}-59f_{n-2}+37f_{n-3}-9f_{n-4})
\end{multline*}
\\
соответственно второго, третьего и четвертого порядка аппроксимации.
Однако в ходе эксперимента выяснилось, что ни один из этих методов
не способен конкурировать в плане погрешности с соответсвующими по
порядку методами Рунге-Кутта, поэтому к полученным по этим схемам
значениям были применены неявные схемы:
\begin{multline*}
\frac{y_{n}-y_{n-1}}{\tau}=\frac{1}{12}(5f_{n}+8f_{n-1}-f_{n-2})\\
\frac{y_{n}-y_{n-1}}{\tau}=\frac{1}{24}(9f_{n}+19f_{n-1}-5f_{n-2}+f_{n-3})\\
\frac{y_{n}-y_{n-1}}{\tau}=\frac{1}{720}(251f_{n}+646f_{n-1}-264f_{n-2}+106f_{n-3}-19f_{n-4})
\end{multline*}
\\
порядком на 1 выше соответствующего явного метода, после чего были
получены сопоставимы с методами Рунге-Кутта погрешности.

В отношении устойчивости и сходимости данных методов справедлива теорема\citet[, с. 234]{key-1}:\\
Если метод \ref{eq:many_steps} удовлетворяет условию корней и имеет
порядок аппроксимации $p$, $|f_{u}(t,u)|\leq L$ при $0\leq t\leq T$.
Тогда при $m\tau\leq t_{n}=n\tau\leq T,\, n\geq m$ и достаточно малых
$\tau$ выполнена оценка 
\[
|y_{n}-u(t_{n})|\leq M(\underset{0\leq j\leq m-1}{max}|y_{j}-u(t_{j})|+\underset{0\leq k\leq n-m}{max}|\psi_{k}|),
\]
\\
где $\psi_{k}$- погрешность аппроксимации, $y_{j}-u(t_{j})$ - погрешности
в задании начальных условий, $M(L,T)$ - константа, не зависящая от
$n$. Если эти погрешности имеют порядок $O(\tau^{p}),$ то и вся
схема сходится с данным порядком точности. Нужно отметить, что для
методов Адамса условие корней характеристического уравнения всегда
выполнено.

При каждом шаге $\tau$ построенных здесь методов производится 2 вычисления
правой части $f$ уравнения вне зависимости от порядка метода, однако
важную проблему представляет выбор начальных значений $y_{i}$. Исходя
из теоретической оценки сходимости методов и результатов вычислительного
эксперимента, начальные значения лучше всего вычислять методом Рунге-Кутта
порядка, соответсвующего порядку предиктора или более высокого.


\subsection{Методы интерполирования}

При решении реальных задач вместо аналитического выражения функции
зачастую имеются лишь таблица ее значений в некоторых точках времени
и/или пространства. Например, для задачи адвекции в реальной среде
может быть установлено ограниченное количество измерительных приборов,
замеряющих характеристики среды лишь в некоторых точках пространства.
Эти замеры могут производится не непрерывно, а через дискретные промежутки
времени. В этом случае, для получения значения в произвольной точке
пространства-времени используются приближенные формулы, рассчитываемые
по известным значениям. При этом, от строящегося приближения требуется
как точность аппроксимации исходной функции, так и достаточно простой
и удобный для работы вид. 


\subsubsection{Одномерная интерполяция}


\paragraph{Интерполяционные полиномы Ньютона и Лагранжа}

Пусть известны значения функции $f(x)$ в точках $x_{0},...,x_{n}\in[a,b]$.
Задача интерполирования алгебраическими многочленами состоит в нахождении
функции $L_{n}(x)=a_{0}+a_{1}x+...a_{n}x^{n}$, которая в заданных
точках $x_{k}$ совпадает c известными значениями $f(x_{k})$. Такой
многочлен $L_{n}(x)$ называется интерполяционным многочленом для
функции $f(x)$, построенным по узлам $\{x_{k}\}$ Для любой непрерывной
функции сформулированная задача имеет единственное решение. Интерполяционный
многочлен можно записать различным образом. Самыми распространенными
являются формы Лагранжа и Ньютона.

\begin{align}
L_{n}(x) & =\sum_{k=0}^{n}c_{k}(x)f(x_{k})\nonumber \\
 & c_{k}(x)=\frac{{\displaystyle \prod_{i\neq j}(x-x_{i})}}{{\displaystyle \prod_{i\neq j}(x_{j}-x_{i})}}\label{eq:Legrange}
\end{align}


Формула \ref{eq:Legrange} представляет интерполяционный многочлен
в виде линейной комбинации значений в узлах. Эта форма носит название
интерполяционного многочлена Лагранжа.

\begin{multline}
L_{n}(x)=f(x_{0})+(x-x_{0})f(x_{0},x_{1})+(x-x_{0})(x-x_{1})f(x_{0},x_{1},x_{2})+...\\
...+(x-x_{0})(x-x_{1})...(x-x_{n-1})f(x_{0},x_{1},...x_{n})\label{eq:Newton}
\end{multline}


Данная форма представляет собой разностный аналог формулы Тейлора,
записанная посредством разделенных разностей (можно расписать). Она
носит название интерполяционного многочлена Ньютона. Погрешность интерполяции
в данном случае имеет вид 
\begin{equation}
|f(x)-L_{n}(x)|\leq\frac{M_{n+1}}{(n+1)!}|\prod_{i=0}^{n}(x-x_{i})|,\; M_{n+1}=max|f^{(n-1)}(\xi)|\label{eq:Newton_err}
\end{equation}
 В вычислительном эксперименте, для нестационарного поля скорости,
известного лишь в моменты $t_{i}$ для интерполяции по времени были
применены кусочные линейные, квадратичные и кубические интерполяционные
полиномы. Для их построения, ввиду малого порядка полинома и характерной
особенности данной задачи в случае ансамбля частиц - одного набора
$x$ и достаточно большого числа частиц $N$, было использовано непосредственное
решение системы интерполяционных условий путем обращения матрицы,
с порядком сложности $O(p^{3})$, где $p-$ порядок полинома.


\paragraph{Интерполяция Эрмитовым кубическим сплайном}

Для повышения точности интерполяции на интервале $[a,b]$ мы можем
не только просто увеличить число узлов интерполяции, тем самым подняв
степень полинома, но вместо этого, разбить интервал $[a,b]$ на частичные
отрезки и на каждом из них приблизить функцию полиномом небольшой
степени. Для этого можно воспользоваться аппаратом сплайн-функций.
Сплайном степени $n$ дефекта $m$ называют кусочно-полиномиальную
функцию, определенную на отрезке $[a,b]$ и имеющую на этом отрезке
некоторое число непрерывных производных 
\begin{equation}
S_{n,m}(x)=\sum_{k=0}^{n}a_{ik}x^{k},\; x_{i-1}\leq x<x_{i},\; a_{ik}\in\mathbb{R},\; S\in C^{n-m,}[a,b],m<n,\; i=0..n-1\label{eq:Spline}
\end{equation}
 Интерполяционным сплайном естестественно назвать сплайн, для которого
на сетке $\omega(x,N)$ справедливо $S_{n,m}(x_{i})=f_{i},\, i=0..N$.
Преимуществом сплайнов по сравнению с обычной интерполяцией является,
во-первых, сходимость, и во-вторых, устойчивость процесса вычислений.

Для построения интерполяционных сплайнов в общем случае требуется
решать СЛАУ, размерность которой зависит от интерполяционных условий
и может быть велика. Однако для сплайнов, носящих название Эрмитовых
или локальных эта система распадается на совокупность подсистем небольшой
размерности\citet[, c.58]{key-4}.

Пусть дана сетка $\omega(x)=x_{0}<x_{1}<...<x_{n}$ на которой затабулированы
значения функции $f(x)$ и ее первой производной. Тогда Эрмитовым
кубическим сплайном назовем функцию $S_{3,2}(f,x),$ удовлетворяющую
условиям:
\begin{align*}
S_{3,2}(x) & =a_{i0}+a_{i1}(x-x_{i})+a_{i2}(x-x_{i})^{2}+a_{i3}(x-x_{i})^{3},\; i=0..n\\
 & S_{3,2}(x_{i})=f_{i},\, S_{3,2}^{'}(x_{i})=f_{i}^{'},i=0,..,N
\end{align*}


Оценка погрешности интерполяции для данного сплайна $R(x)\leq\frac{3}{8}\bar{h}\omega(f')$.

Потенциальной проблемой, мешающей использованию Эрмитовых сплайнов
для интерполяции является необходимость табуляции значений производных.
Однако ценой некоторого увеличения погрешности можно воспользоваться
приближенными формулами для вычисления производных с помощью конечных
разностей\citet[с.73]{key-4}. В этом случае оценка погрешности будет
иметь следующий вид \inputencoding{latin9}\foreignlanguage{english}{$R(x)\leq\frac{5}{8}\bar{h}\omega(f')$}\inputencoding{koi8-r}.
В рамках численного эксперимента был применен этот метод построения
интерполяционного Эрмитового сплайна.


\paragraph{Интерполяция сплайнами класса $S_{3,1}$}

Еще одним широко применяемым для интерполяции подвидом сплайн-функций
является класс сплайнов $S_{3,1}(x)$. Этот сплайн происходит из Эрмитового
сплайна $S_{3,2}(x)$ при наложении на сплайн условия непрерывности
вторых производных сплайна. Следствием этого является потеря свойства
локальности сплайна, и необходимость решения трехдиагональной СЛАУ
размерности $N-2$.

В вычислительном эксперименте применялся интерполяционный кубический
сплайн 
\begin{align}
S_{3,1}(x) & =f_{i}(1-t)^{2}(1+2t)+f_{i+1}t^{2}(3-2t)+m_{i}h_{i}t(1-t)^{2}-m_{i+1}h_{i}t^{2}(1-t)\label{eq:S31}\\
 & m_{i}=S'(x_{i}),\; h_{i}=x_{i+1}-x_{i-1},\; x\in[x_{i},x_{i+1}],\; t=\frac{x-x_{i}}{h_{i}}\nonumber 
\end{align}
\\
записанный через наклоны, для которого находились неизвестные коэффициенты
$m_{i}$. В общем случае, погрешность интерполяции зависит от $\omega(f)=max(f(x')-f(x'')),\;\forall x',x''\in[a,b]$
и шагов сетки. Для сплайнов с нулевыми граничными моментами эта оценка
принимает вид:

\begin{align*}
 & \parallel S(x)-f(x)\parallel_{C}\leq(1+\frac{3}{4}\beta)\omega(f)\\
 & f(x)\in C[a,b],\;\beta=\frac{max\, h_{i}}{min\, h_{i}}
\end{align*}


Для построения сплайна по $N$ узлам - т.е нахождения коэффициентов
системы и решения ее методом прогонки потребуется порядка $18N$ операций.


\subsubsection{Двумерная интерполяция}

Для случая, когда поле скорости известно лишь в некоторых точках пространства
$\mathbb{R}^{2}$ для получения значений компонентов поля скорости
в произвольной точке требуется проводить двумерную интерполяцию.


\paragraph*{Двумерная полиномиальная интерполяция}

Самым простым подходом для интерполяции на двумерной прямоугольной
сетке является последовательная интерполяция. В самом деле, для точки
$(x^{*},y^{*})$ выберем на сетке прямоугольник из $km$ узлов, содержащий
искомую точку, затем проведем одномерную интерполяцию $P_{k}^{m}(x)$
для каждой из $m$ строк, после чего вычислим $m$ значений $P_{k}^{m}(x*)$
и для полученных значений проведем одномерную интерполяцию $P_{m}(y)|_{y=y*}=P_{m}(y^{*})$.
Такой подход позволяет брать по каждой переменной свое число узлов.\citep[с. 50]{key-3}

Общая формула при таком подходе аналогична одномерной формуле Лагранжа:

\begin{equation}
P_{km}(x,y)=\sum_{i=0}^{k}\sum_{j=0}^{m}z_{ij}\prod_{\underset{p\neq i}{p=0}}^{k}\prod_{\underset{q\neq i}{q=0}}^{m}\frac{(x-x_{i})(y-y_{j})}{(x_{p}-x_{i})(y_{q}-y_{j})}\label{eq:Lagrange2d}
\end{equation}


Как можно заметить, формулы многомерной лагранжевой интерполяции весьма
громоздки, поэтому на практике применяются полиномы невысоких степеней.\\
В вычислительном эксперименте были применены методы билинейной, биквадратичной
и бикубической интерполяции, получающиеся из формулы \ref{eq:Lagrange2d}
при $m=k=1,2,3$ соответственно.


\paragraph*{Двумерная интерполяция с помощью сплайнов}

Функция $S_{n,m,\nu,\mu}(x,y)$ является сплайном двух переменных
степени $n$ дефекта $\nu$ по $x$ и степени $m$ дефекта $\mu$
по $y$, если в каждой ячейке прямоугольной сетки $\Omega$ является
многочленом вида: 
\begin{align}
S_{n,m,\nu,\mu}(x,y) & =\sum_{\alpha=0}^{n}\sum_{\beta=0}^{m}a_{\alpha\beta}^{ij}(x-x_{i})^{\alpha}(y-y_{j})^{\beta}\label{eq:2dSpline}\\
 & i=0,...,N-1\; j=0,...,M-1\nonumber \\
 & S_{n,m,\nu,\mu}(x,y)\in C^{n-\nu,m-\mu}(\Omega)\nonumber 
\end{align}


При этом, мн-во сплайнов \ref{eq:2dSpline} является результатом тензорного
произведения $S_{n,m,\nu,\mu}(x,y)=S_{n,\nu}(x)\otimes S_{m,\mu}(y)$
\citep[c. 37]{key-4}. Таким образом, тот же подход последовательной
интерполяции применим и для двумерной интерполяции с использованием
сплайнов. Для двумерной интерполяции поля скорости были использованы
происходящие из соответственно Эрмитового интерполяционного сплайна
$S_{3,2}(x)$ и кубического сплайна $S_{3,1}(x)$ кубические сплайны
$S_{3,3,2,2}(x,y)$ и $S_{3,3,1,1}(x,y)$. Оценки погрешности в этом
случае имеют весьма сложный вид, и не будут приводится в данном тексте.
см. \citep[с. 137]{key-4}

Для построения сплайна $S_{3,3,2,2}$ на сетке $N\times N$ требуется
решить $3N$ одномерных задач. Таким образом, задача построения сплайна
в целом потребует $54N^{2}$ операций.


\section{Вычислительный эксперимент}

Для описанной в 2.1 - 2.2 общей задачи было подобрано такое поле скорости,
которое допускает получение точного аналитического решения задачи
\ref{eq:ODE_system}-\ref{eq:Start_cond}. Пусть в поле скорости присутствует
только тангенциальная компонента $V_{\tau}(r,t)$. Тогда правые части
системы примут вид:
\begin{align}
u(x,y) & =-V_{\tau}(r,t)sin(\Theta),\nonumber \\
v(x,y) & =+V_{\tau}(r,t)cos(\Theta)\label{eq:wind_field}
\end{align}
\\
, где $r=\sqrt{x^{2}+y^{2}},\;\Theta=arctg(\frac{y}{x})$ - полярные
координаты. Из курса теоретической механики известно (ссылка), что
траектория движения частицы в таком поле скорости будет окружность,
т.е $\frac{\partial r}{\partial t}=0$. Поэтому несложно получить
решение системы в полярных координатах: 
\begin{align*}
r & =const,\\
 & \theta=\frac{V_{\tau}(r,t)}{r}t+const
\end{align*}
\\
Решение в интересующей нас декартовой системе координат получим обратным
преобразованием координат. 

Для первых тестов было взято постоянное во времени поле скорости с
$V_{\tau}(r)=sech^{2}(r)tanh(r)$. 

Промежуток времени $[0,T]$ был выбран из расчета, чтобы частица с
максимальной скоростью совершила два полных оборота вокруг центра
$(0,0)$ - $T=32.$ 

Затем в поле скорости была добавлена периодическая часть, для проверки
методов интегрирования в нестационарном поле скорости, $V_{\tau}(r,t)=sech^{2}(r)tanh(r)(1+sin(\lambda t))$.

Во всех случаях, для оценки точности решения в поле скорости помещалась
группа из 20 частиц, равномерно распределенных с шагом $0.1$ по оси
$Oy$ от центра $(0,0)$. На каждом шаге для каждой отдельной частицы
вычислялась погрешность $\varepsilon=\sqrt{(x-\tilde{x})^{2}+(y-\tilde{y})^{2}}$,
где $(x,y)$- значение аналитического решения в момент $t$, а $(\tilde{x},\tilde{y})$
- численное решение задачи в момент времени $t$. По окончании расчетов
максимальные полученные для каждой частицы погрешности усреднялись,
и полученный результат рассматривался как оценка точности.

Для первого теста было взято стационарное поле скорости, помещены
тестовые частицы и проведено интегрирование различными многошаговыми
методами и методами Рунге-Кутта.
\begin{figure}[H]
\includegraphics[scale=0.5]{\string"/home/artem/Dropbox/Octave/Octave 3/Simple/pic/test2-err\string".eps}\includegraphics[scale=0.5]{pic/test2-time}\caption{Асимптотика погрешностей при измельчении шага(слева)\protect \\
и временных затрат на решение.}
\end{figure}


Исходя из графиков, можно заключить, что 
\begin{enumerate}
\item асимптотическое поведение погрешностей методов Рунге-Кутта соответствует
теоретическим оценкам. 
\item асимптотическое поведение погрешностей неявного метода Адамса 4го
порядка соответствует ожиданиям, в то время, как неявный метод Адамса
5го порядка практически полностью уступает методу Рунге-Кутта 4го
порядка
\item фактические временные затраты на решение ведут себя в соответствии
с ожиданиями, в зависимости от числа вычислений правой части, хотя,
в силу малого масштаба эксперимента разница пока не ощутима.
\end{enumerate}
Во втором тесте зафиксируем шаг интегрирования $h_{1}=0.25$ и добавим
к полю скорости нестационарную компоненту: $V_{\tau}(r,t)=sech^{2}(r)tanh^{2}(r)(1+sin(t*P))$,
где $P$ - параметр, определяющий период изменения тангенциальной
скорости: $T=\frac{2\pi}{P},\; P\neq0$. 

\begin{figure}[H]
\includegraphics[scale=0.5]{pic/test4-02}\caption{Зависимость погрешности решения от $P$}
\end{figure}


По итогам этого теста можно отметить, что методы Рунге-Кутта ведут
себя чуть более устойчиво по отношению к периоду изменения поля скорости.
По итогам

В третьем тесте вернемся к стационарному полю скорости, но заданному
в узлах пространственной сетки. Ограничимся использованием двух наиболее
точных методов - Рунге-Кутта 4 порядка, и метода Адамса 5го порядка,
и набора методов интерполяции по пространству. с различными шагами
$h_{2}$
\begin{figure}[H]
\includegraphics[scale=0.45]{pic/test5-1}\includegraphics[scale=0.45]{pic/test5-2}

\caption{погрешности методов Адамса(слева) и Рунге-Кутта \protect \\
в зависимости от примененных методов интерполирования по пространству.}
\end{figure}


Как видно, графики для двух различных методов интегрирования практически
неотличимы, при этом произошло существенное увеличение погрешности
минимум на два порядка.

\begin{figure}[H]
\includegraphics[scale=0.45]{pic/test5-InterpTime1}\includegraphics[scale=0.45]{pic/test5-InterpTime2}

\caption{Временные затраты на интерполирование поля скорости в секундах}
\end{figure}


Исходя из временных затрат, и точности вычислений, можно сделать вывод
о том, что билинейная интерполяция не подходит к применению. Метод
интерполяции сплайнами $S_{3,3,1,1}$ показал наилучшие результаты
по точности, но и высокие временные затраты, что может сильно осложнить
дело при многократном интерполировании. Квадратичные, кубические полиномы
и эрмитовы сплайны показали схожие результаты, но квадратичный полином
был чуть менее точным и быстрым способом интерполяции, поэтому он
тоже исключается из дальнейших тестов.

Помимо нестационарного поля скорости, еще одним осложняющим задачу
фактором будет то, что поле скорости может быть задано только в узлах
сетки. Теперь потребуется процедура интерполяции для определения значений
скорости в произвольных точках. Отберем два наиболее точных и интересных
метода по результатам предыдущих тестов - методы Адамса и Рунге-Кутта
4го порядка и проведем для мн-ва точек, как и в тесте 1, тест на финальную
погрешность, при шаге сетки по времени $h=0.4$, шаге сетки по пространству
$h_{2}=0.25$ и стационарном поле скорости:

\begin{figure}[H]
\includegraphics[scale=0.45]{pic/test5-1}\includegraphics[scale=0.45]{pic/test5-2}\caption{ Сравнение методов интерполяции для методов Адамса(слева) и Рунге-Кутта
4 порядка}
\end{figure}


Видно, что наибольшую погрешность дают методы интерполяции при близких
к центру положениях частицы и при максимальных значениях скорости
$V_{\tau}$ Попробуем проанализировать зависимость погрешности для
частицы $(0,0.1)$ от шага пространственной сетки.
\begin{figure}[H]
\includegraphics[scale=0.45]{pic/test6-1}\includegraphics[scale=0.45]{pic/test6-2}\caption{Зависимость максимальной погрешности от шага $h_{2}$}
\end{figure}


В целом можно отметить схожее поведение погрешности для обоих методов.
Можно отметить, что при шаге $h=0.1$ наблюдается практически полное
равенство погрешностей c точностью порядка $0.01$, однако абсолютно
лучшим и устойчивым при дальнейшем увеличении шага показала себя интерполяция
кубическими сплайнами $S_{3,1}$.(Вычислительная сложность???!!!)

Теперь рассмотрим, как поведут себя комбинированные методы при фиксированном
шаге $h_{2}=0.4$ и различных периодах изменения во времени тангенциальной
скорости: 

\begin{figure}[H]
\includegraphics[scale=0.45]{pic/test7-1}\includegraphics[scale=0.45]{pic/test7-2}\caption{Зависимость погрешности от периода изменения поля скорости}
\end{figure}


Можно отметить, что для метода Адамса лучшие результаты дало применение
кубической интерполяции, в то время, как для метода Рунге-Кутта минимальную
погрешность дала интерполяция кубическими сплайнами $S_{3,1}$.

Теперь дискретизируем дополнительно еще и временной интервал $[0,T]$,
так что для вычисления значений поля скорости в моменты времени $t\neq rh_{3}$
потребуется применить одномерную интерполяцию. 

\begin{figure}[H]
\includegraphics[scale=0.45]{pic/test9-1}\includegraphics[scale=0.45]{pic/test9-2}\caption{}


\end{figure}



\section{Список литературы}
\begin{thebibliography}{1}
\bibitem{key-1}Самарский А.А., Гулин А.В ``Численные методы: Учеб.
пособие для вузов.'' - М.:Наука., 1989.-432 с.

\bibitem{key-2}Charles A. Doswell, ``A kinematic analysis of frontogenesis
associated with a nondivergent vortex.''- Journal of the athmospheric
sciences, 1983. 

\bibitem{key-3}Калиткин Н.Н ``Численные методы'', М.: Наука, 1978.-512
стр.

\bibitem{key-4}Завьялов Ю. С., Квасов Б.И., Мирошниченко В.Л. ``Методы
сплайн-функций.'' - М.:Наука., 1982.-352с

\bibitem{key-5}Шепелева Р.П ``Курс лекций по обыкновенным дифференциальным
уравнениям.'' - Владивосток: Издательство Дальневосточного Университета,
2006.

\bibitem[6]{key-6}Григорьев Ю.Н., Вшивков В.А., Федорук М.П., ``Численное
моделирование методами частиц в ячейках'', Новосибирск, Изд-во РАН,
2004, 360с.

\bibitem[7]{key-7}Гуржий А. А., Прокопович И.С. ``Адвекция пассивной
жидкости в поле скорости двух точечных вихрей в круговой области''
// Вестник Харьковского национального университета, \textnumero{}847,
2009, с.123 - 130.\end{thebibliography}

\end{document}
